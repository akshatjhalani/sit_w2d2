name: train-my-model
on: [push]
jobs:
  run:
     runs-on: [ubuntu-latest]
     container: docker://dvcorg/cml-py3:latest
     steps:
        - uses: actions/checkout@v2
        - name: cml_run
           run: |
              echo "Downloading Data"
              wget "https://drive.google.com/uc?export=download&id=1n5eXzMnf_Jztkky7ZmzfUq2QHWpD6LUN"
              echo "Data Downloaded"
              mkdir -p /content/drive/MyDrive/Introduction2DataScience/W2D2_Assignment/w2d2/data/raw/
              mkdir -p /content/drive/MyDrive/Introduction2DataScience/W2D2_Assignment/w2d2/models/
              echo "Directory structure completed"
              pip install -r requirements.txt
              python train.py
              cat metrics.txt >> report.md
              cml-publish confusion_matrix.png --md >> report.md
              cml-send-comment report.md